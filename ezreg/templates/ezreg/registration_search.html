{% extends 'base.html' %}
{% block headend %}
<script src="/static/ezreg/js/pages/registration_search.js"></script>
{% endblock %}
{% block content %}
<script type="text/ng-template" id="checkbox_filter.html">
    <input type="checkbox" name="{{name}}" ng-model="params.filter()[name]" class="input-filter form-control" ng-value="'True'" ng-true-value="'True'" ng-false-value="'False'" />
</script>
<script type="text/ng-template" id="path/to/your/filters/number.html">
    <input type="text" name="{{name}}" ng-disabled="$filterRow.disabled" ng-model="params.filter()[name]" class="input-filter form-control" maxlengh="4" angular-mask="0000" placeholder="nnnn" />
</script>
<div ng-controller="RegistrationSearchController" ng-init='init({{statuses|safe}},{{payment_statuses|safe}} );'>
    <table ng-table="tableParams" show-filter="true" class="table table-bordered table-striped table-condensed">
      <tr ng-repeat="row in $data track by row.id">
        <td data-title="'Registered'" sortable="'registered'" style="width:170px">{[row.registered | date:'short']}</td>
        <td data-title="'Event'" filter="{event__title__icontains: 'text'}" sortable="'event__title'"><a href="{[ getURL('manage_event',{event:row.event}) ]}">{[row.event__title]}</a></td>
        <td data-title="'First Name'" filter="{first_name__icontains: 'text'}" sortable="'first_name'">{[row.first_name]}</td>
        <td data-title="'Last Name'" filter="{last_name__icontains: 'text'}" sortable="'last_name'">{[row.last_name]}</td>
        <td data-title="'Email'" filter="{email__icontains: 'text'}" sortable="'email'">{[row.email]}</td>
        <td data-title="'Amount'" sortable="'payment__amount'">{[row.payment__amount]}<span ng-if="row.payment__refunded"> - {[row.payment__refunded]} refunded</span></td>
        <td data-title="'Processor'" >{[row.payment__processor]}</td>
		<td data-title="'Status'" filter="{status: 'select'}" filter-data="statuses_filter_choices">{[statuses[row.status]]}</td>
		<td data-title="'Payment Status'" filter="{payment__status: 'select'}" filter-data="payment_status_filter_choices">{[payment_statuses[row.payment__status]]}</td>
		<td data-title="'Test'" filter="{test: 'checkbox'}"><i ng-if="row.test" class="glyphicon glyphicon-ok"></i></td>
      </tr>
    </table>

{% endblock %}